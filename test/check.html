<!DOCTYPE html>
<html>
    <head>
        <title>Are Custom Elements Ready ?</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
        <meta charset="utf-8">
        <style>
            pre {
                padding: 0;
                margin: 0;
            }
            code {
                display: block;
                padding: 8px;
                font-size: 1.1em;
            }
            .ok {
                background: #90EE90;
            }
            .partial {
                background: #63FF47;
            }
            .error {
                background: #FF6347;
            }
        </style>
    </head>
    <body>
        <pre><code>class MyDiv extends HTMLDivElement {}</code></pre>
        <pre><code>customElements.define('my-div', MyDiv, {extends: 'div'});</code></pre>
        <pre><code>document.createElement('div', {is: 'my-div'});</code></pre>
        <pre><code>new MyDiv();</code></pre>
        <script>
        window.polyfilled = /(?:\?|\#)poly/.test(location.href);
        if (polyfilled) document.write([
            '<!--[if lte IE 9]><script>(function(f){window.setTimeout=f(window.setTimeout);window.setInterval=f(window.setInterval)})(function(f){return function(c,t){var a=[].slice.call(arguments,2);return f(function(){c.apply(this,a)},t)}});<' + '/script><![endif]-->',
            '<!--[if IE 8]><script src="//cdnjs.cloudflare.com/ajax/libs/ie8/0.2.3/ie8.js"><' + '/script><![endif]-->',
            '<script src="//cdnjs.cloudflare.com/ajax/libs/dom4/1.8.3/dom4.js"><' + '/script>',
            '<!--[if IE 8]><script src="build/dre-ie8-upfront-fix.js"><' + '/script><![endif]-->',
            '<script src="build/document-register-element.max.js"><' + '/script>'
        ].join(''));
        this.onload = function () {
            for (var
                code = document.getElementsByTagName('code'),
                commonTest = 'return MyDiv.invoked && /^div$/i.test(md.nodeName) && /^my-div$/i.test(md.getAttribute("is"))',
                test = [
                    [
                        'try {',
                            'class MyDiv extends HTMLDivElement {',
                                'constructor(self) { self = super(self); MyDiv.invoked = true; return self; }',
                            '};',
                            'window.MyDiv = MyDiv',
                            'return "ok";',
                        '} catch(e) {',
                            'return "error";',
                        '}'
                    ].join('\n'),
                    [
                        'try {',
                            'customElements.define("my-div", MyDiv, {extends: "div"});',
                            'return "ok";',
                        '} catch(e) {',
                            'return "error";',
                        '}'
                    ].join('\n'),
                    [
                        'try {',
                            'var md = document.createElement("div", {is: "my-div"});',
                            commonTest + '? "ok" : "partial";',
                        '} catch(e) {',
                            'return "error";',
                        '}'
                    ].join('\n'),
                    [
                        'try {',
                            'var md = new MyDiv();',
                            commonTest + '? "ok" : "partial";',
                        '} catch(e) {',
                            'return "error";',
                        '}'
                    ].join('\n')
                ],
                i = 0; i < code.length; i++
            ) {
                code[i].className = Function('"use strict";' + test[i])();
            }
        };
        </script>
    </body>
</html>